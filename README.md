# NN-EnergyProductionPrediction

Со помош на библиотеките Keras и Tensorflow во Python изградив 3 модела базирани на невронски мрежи.

## I.	Модел базиран на повторувачка невронска мрежа RNN

Првиот модел (со две имплементациии: SmallHPP_HourlyPrediction и SmallHPP_DailyPrediction) е базиран на повторувачка (рекурентна) невронска мрежа која содржи четири Long Short Term Memory (LSTM) единици во влезниот слој и еден неврон во излезниот слој.

SmallHPP_HourlyPrediction го предвидува количеството на произведена електрична енергија од мали хидроцентрали за следниот час со познато производтсво за претходниот час, а SmallHPP_DailyPrediction предвидува за следните 24 часа (за следениот ден) со познато производтсво од претходниот ден.
Со промена на соодветен параметар можно е за предвидувањето да се земат во предвид (како влезни карактеристики) производствата од повеќе претходни часа/дена.

Подетално за SmallHPP_DailyPrediction:
![1](https://user-images.githubusercontent.com/29215159/53731660-cc3d9c00-3e7b-11e9-9db4-fe8b0e48f8fd.png)
Слика 1. Графички приказ на податоците.

Y оската е количеството на произведена електрична енергија, а X оската се изминатите денови (период 01.01.2015 до 31.12.2017).

Видејќи за предикција на временски податоци е битен редоследот, првите 80% ги земаме за тренинг, а последните 20% за тестирање.

После тренирање на моделот и евалуирање со множеството за тестирање се добива:
-	mean absolute error: 0.022
-	mean squared error: 0.0024
-	MAAPE: 12%
 
Бидејќи таргет вредносите од податоците содржат нули (постојат денови кога воопшто не е произведена електрична енергија) не може да се користи MAPE (настанува делење со 0 – недефинирано).
Затоа користев варијанта на MAPE (MAAPE – mean absolute arctangent percentage error) каде дополнително се пресметува аркус тангенс бидејќи е дифиниран за сите реални вредности од минус до плус бескрај.

![2](https://user-images.githubusercontent.com/29215159/53731741-fabb7700-3e7b-11e9-9a8a-7a10a7ab56fc.png)
Слика 2. Графички приказ на таргет вредностите од тренинг множеството.

Со сино се претсавени вистинските вредности, а со портокалово предвидените вредности со помош на изградениот модел.

![3](https://user-images.githubusercontent.com/29215159/53731771-0eff7400-3e7c-11e9-8320-9129c0a32aa5.png) 

Меѓутоа, и покрај малата грешка, доколку зумираме на графикот се забележува дека предвидените вредности доцнат за по еден ден, односто предвидената вредност претсавува пропагирање на вредноста од претходниот ден.
Всушност сме добиле persistence model, кој иако не прави огромни грешки не е најдоброто решение.

## II.	Модел базиран на длабока невронска мрежа

Со помош на длабока невронска мрежа правев предивувања за дневно производство на електрична енергија во ветерната електрана во Богданци. Како влезна карактеристика ја користам просечната јачина на ветерот во текот на денот. Кога се прави предвидување, просечната предвидена јачина.
Податоците за јачината на ветерот во период од 2015-2017 година се добиени од мерната станица во Гевгелија, која е во најголема близина до ветерната електрана.
Како влезни карактеристики ги тестирав и месецот, денот како и просечната дневна температура но тие не се колерирани со количината на производтсво и не допринесуваат за поточни предвидувања. 
Според направеното истражување влијание врз количината на произведена енергија од ветерни турбини, покрај јачината на ветерот има и густината на воздукот (податоци кои не успеав да ги пронајдам), а температурата има влијание само кога достигнува екстремни вредности (под -20 и над 50 степени), какви што не доспева во околината на електраната и затоа таа не е релевантна.
Подолу е дадена зависноста помеѓу количината на произведена електрична енергија и денот од годината (Слика 3 - нема зависност) и јачината на ветерот (Слика 4 –скоро линеарна зависност, но веројатно квадратна).

![33](https://user-images.githubusercontent.com/29215159/53731810-38200480-3e7c-11e9-90a0-29dc02684ba6.png) 
Слика 3. Зависнот помеѓу производството на ел. енергија и ден од годината.

![4](https://user-images.githubusercontent.com/29215159/53731813-38200480-3e7c-11e9-99d5-9ffa2255e469.png) 
Слика 4. Зависнот помеѓу производството на ел. енергија и јачина на ветер.

Во имплементацијата, се елиминираат податоците кои многу отстапуваат – outliers, за моделот полесно да се истренира, и се врши нормализација, по што се добива:

![4 1](https://user-images.githubusercontent.com/29215159/53731811-38200480-3e7c-11e9-9c00-55a58c2f9931.png) 
Слика 4.1. Зависнот помеѓу производството на ел. енергија и јачина на ветер со отсранети outliers.
Невронската мрежа е длабока невронска мрежа со влезен слој кој содржи 64 неврони, прв скриен слој со 28 неврони, втор скриен слој со 8 неврони и излезен слој со еден неврон. Невроните во мрежата се целосно поврзани – dense слоеви. 

По тренирањето на мрежата и евалуирање со помош на тренинг податоците се добива:

![5](https://user-images.githubusercontent.com/29215159/53731881-6b629380-3e7c-11e9-9159-ff6b198b58ae.png) 
Слика 5. Графички приказ на таргет вредностите од тренинг множеството.

Со сино се претсавени вистинските вредности, а со портокалово предвидените вредности со помош на изградениот модел.

Добиените грешки за тренинг податоците се следниве:
-	mean squared error: 0.0159
-	mean absolute error: 0.098

*Грешките се пресметани врз нормализирани таргет вредности.

## III.	Подобрен модел на рекурента невронска мрежа

Со помош на ваквиот модел ја предвидувам цената на електричната енергија во Унгарија, за следниот час, со позната цена за претходниот (HUPrices_Prediction.txt).
Временските податоци, се разгледуваат како секвенцијални, односно битен е
нивниот редослед.
Добиената MAPE изнесува 4.95%.

![6](https://user-images.githubusercontent.com/29215159/53731879-6b629380-3e7c-11e9-9741-e998b7dff5e8.png)

Графички приказ на реалните вредности со сино, и предвидените вредности со портокалово.

![7](https://user-images.githubusercontent.com/29215159/53731880-6b629380-3e7c-11e9-94db-d860e754c736.png)

Втората слика е само за првите 100 податоци од тест множеството со цел да воочиме дека ке постои изразен lag како кај првиот модел, односно овој модел прави пореални предикции, не ја само пропагира вредноста од претходниот час.

Го тестирав моделот и на останатите множества од податоци, меѓутоа за ова прави најреални предвидувања, моја претпоставка е затоа што податоците тука се најмногу стационарни, што веројатно е битно за тренирање на моделот.

